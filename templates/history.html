<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP&display=swap" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

  <!-- Auto Complete -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tarekraafat/autocomplete.js@7.2.0/dist/css/autoComplete.min.css">
  <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='style.css') }}">
    <style>

        body {
            background-color: black;
            background-image: none;
        }

                            /* Style for the image */
         .responsive-img {
            max-width: 650px; /* Adjust the maximum width to your needs */
            height: auto; /* Maintain aspect ratio */
            border-radius: 30px; /* Optional: Add rounded corners */
            mask-image: linear-gradient(to right, black 50%, rgba(0, 0, 0, 0));
            -webkit-mask-image: linear-gradient(to right, black 50%, rgba(0, 0, 0, 0)); /* For WebKit browsers */
            margin: 12px auto; /* Optional: Center the image and add space around it */
            margin-left: 12px;
        }

        .container1 {
            position: inherit;
            /* border: 2px solid white; */
            border-radius: 40px;
            background-color: black;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px;
            margin: 20px;
            width: 100%;
            padding-left: 80px;
            margin-right: -4px;
        }

        @media (min-width: 1200px) {
    .container1 {
        max-width: 1420px;
    }
}

        .text {
            padding-left: 20px;
            padding-right: 20px;
        }

        .text {
            color: white;
        }

        .description {
            font-size: 16px;
        }

        .heading {
            color: rgb(228, 228, 6);
        }

        #movies-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between; /* Ensure equal space between cards */
    gap: 20px; /* Define the gap between cards */
    margin: 35px auto;
    max-width: 1200px; /* Adjust max-width for large screens */
}

.movie-card {
    background-color: #333;
    color: white;
    border-radius: 10px;
    width: calc(20% - 20px); /* Adjusted for 5 cards per row with space */
    height: 400px;
    text-align: center;
    box-sizing: border-box;
    overflow: hidden;
    /* box-shadow: 0px 1px 15px 4px rgba(250, 250, 250, 1); */
    cursor: pointer;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.movie-card img {
    width: 100%;
    height: 320px;
    object-fit: cover;
    border-bottom: 1px solid #444;
}


    .movie-card h3 {
        margin: 10px 0 0; /* Add margin to the top only */
        font-size: 1em; /* Adjust font size if needed */
        /* overflow: hidden; Hide overflow text to maintain card size */
        /* text-overflow: ellipsis; Add ellipsis for overflow text */
        /* white-space: nowrap; Prevent text from wrapping */
        margin-left: 10px;
        margin-right: 10px;
    }
    
    </style>
</head>
    <body id="content" style="font-family: 'Noto Sans JP', sans-serif;background-image: none;">

        <div class="ml-container" style="display: block;">
                  <svg data-toggle="tooltip"
                  data-placement="left" width="80" height="80" viewBox="0 0 250 250"
                style="fill:#e50914; color:#fff; position: fixed;z-index:100; top: 0; border: 0; right: 0;" aria-hidden="true">
                <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
                <path
                  d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
                  fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
                <path
                  d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
                  fill="currentColor" class="octo-body"></path>
                  </svg>
                </a>
        <center><h1> Movie Recommendation System</h1></center>
        <div class="form-group shadow-textarea" style="margin-top: 30px;text-align: center;color: white;">
            <input type="text" name="movie" class="movie form-control" id="autoComplete" autocomplete="off" placeholder="Enter the Movie Name" style="background-color: #ffffff;border-color:#ffffff;width: 60%;color: #181818" required="required" />
            <br>
        </div>
    
        <div class="form-group" style="text-align: center;">
          <button class="btn btn-primary btn-block movie-button" style="background-color: #e50914;text-align: center;border-color: #e50914;width:120px;" disabled="true" >Enter</button><br><br>
        </div>
        </div>
    
      <div id="loader" class="text-center"></div>
      
      <div class="fail">
        <center><h3>Sorry! The movie you requested is not in our database. 
        Please check the spelling or try with other movies!</h3></center>
      </div>
    
        <div class="results">
        <center>
          <h2 id="name" class="text-uppercase"></h2>
        </center>
        </div>


    <div class="container1">
        <div class="img">
            <img src="{{ url_for('static', filename='images/history1.jpg') }}" class="responsive-img" alt="">
        </div>
        <div class="text">
            <h2 class="heading">History</h2>
            <p class="description">The history genre features recounting and analyzing past events, societies, cultures, and historical figures. This genre aims to provide insights into the development of civilizations, the causes and consequences of historical events, and the impact of individuals and ideas on the course of history.</p>
        </div>
    </div>
    <hr>
    <center><h2 style="color: red;">Popular Movies</h2></center>
    <center><p style="color: white;">(Popular History related movies)</p></center>

    <div id="movies-container"></div>

    <div class="posters"></div>

    <script src="https://cdn.jsdelivr.net/npm/@tarekraafat/autocomplete.js@7.2.0/dist/js/autoComplete.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script type="text/javascript" src="{{url_for('static', filename='recommend.js')}}"></script>

    <script>
        window.onload = function() {
            const movies = {{ movies|tojson }}.slice(0 , 20);  // Limit to top 20 movies
            const tmdbApiKey = 'fce0af3409e6113c9b3c75aaf49341bb';

            get_movie_posters(movies, tmdbApiKey);
        };

        function get_movie_posters(arr, my_api_key) {
            var tmdbApiUrl = 'https://api.themoviedb.org/3/search/movie?api_key=' + my_api_key + '&query=';

            arr.forEach(function(movieTitle) {
                const searchUrl = tmdbApiUrl + encodeURIComponent(movieTitle);

                fetch(searchUrl)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error("Network response was not ok: " + response.statusText);
                        }
                        return response.json();
                    })
                    .then(m_data => {
                        const container = document.getElementById('movies-container');
                        if (!container) {
                            console.error("Container not found");
                            return;
                        }

                        if (m_data.results && m_data.results.length > 0 && m_data.results[0].poster_path) {
                            var posterUrl = 'https://image.tmdb.org/t/p/original' + m_data.results[0].poster_path;
                            var voteAverage = m_data.results[0].vote_average;
                            displayMovieCard(movieTitle, posterUrl , voteAverage);
                        } else {
                            console.log("No results or no poster for:", movieTitle);
                            displayMovieCard(movieTitle, 'placeholder_image_url');
                        }
                    })
                    .catch(error => {
                        console.error("Error fetching movie data:", error);
                        alert("Error: " + error.message);
                    });
            });
        }

        function displayMovieCard(title, posterUrl , voteAverage) {
            const container = document.getElementById('movies-container');

            const movieCard = `
                <div class="movie-card">
                    <img src="${posterUrl}" alt="${title} poster" />
                    <p>â˜… ${voteAverage}</p>
                    <h3>${title}</h3>
                </div>
            `;

            // Ensure container exists before updating it
            if (container) {
                container.innerHTML += movieCard;
            } else {
                console.error("Container not found in displayMovieCard function");
            }
        }
    </script>
    
</body>
</html>